<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Concrete Calculator</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');
        :root {
            --primary-color: #2a6fdb; --primary-dark: #1e5abc; --secondary-color: #333; --background-color: #f4f7f6;
            --card-bg: #ffffff; --text-color: #333; --border-color: #e1e1e1;
            --success-color: #28a745; --danger-color: #dc3545; --info-bg: #e9f2ff;
        }
        body { font-family: 'Roboto', sans-serif; background-color: var(--background-color); color: var(--text-color); margin: 0; padding: 20px; }
        .main-container { max-width: 600px; margin: 0 auto; background: var(--card-bg); border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); overflow: hidden; }
        .app-header { padding: 20px; background: var(--secondary-color); color: white; text-align: center; }
        .app-header h1 { margin: 0; font-size: 1.8em; }
        .language-selector { display: flex; justify-content: center; gap: 10px; padding: 15px; background: #f0f0f0; border-bottom: 1px solid var(--border-color); }
        .lang-button { background: #fff; border: 1px solid #ccc; color: #555; padding: 8px 12px; border-radius: 5px; cursor: pointer; font-size: 0.9em; font-weight: 500; transition: all 0.2s; }
        .lang-button.selected { background: var(--primary-color); color: white; border-color: var(--primary-color); }
        .app-body { padding: 25px; }
        .navigation-grid { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 25px; }
        .nav-button { flex-grow: 1; padding: 10px; background: #fff; border: 1px solid #ccc; color: #333; border-radius: 5px; cursor: pointer; font-size: 0.9em; text-align: center; font-weight: 500; transition: background-color 0.2s, color 0.2s, border-color 0.2s; position: relative; }
        .nav-button.active { background: var(--primary-color); color: white; border-color: var(--primary-dark); }
        #running-totals-bar { display: none; justify-content: space-between; align-items: center; padding: 10px 15px; background: var(--info-bg); border: 1px solid var(--primary-color); border-radius: 5px; margin-bottom: 25px; font-size: 0.9em; position: sticky; top: 10px; z-index: 100; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .app-view { display: none; }
        .app-view.active { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .form-group, .results-container, .unit-toggle-container, #instructions-view ul { border: 1px solid var(--border-color); border-radius: 8px; margin-bottom: 20px; padding: 15px; }
        .form-row { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #f0f0f0; }
        .form-row:last-child { border-bottom: none; }
        .input-group { display: flex; align-items: center; gap: 8px; }
        .input-group input { width: 80px; text-align: right; padding: 5px 8px; border: 1px solid #ccc; border-radius: 4px; }
        .unit-toggle-container { display: flex; justify-content: space-between; align-items: center; }
        .toggle-switch { position: relative; display: inline-block; width: 50px; height: 28px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 28px; }
        .slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--primary-color); }
        input:checked + .slider:before { transform: translateX(22px); }
        .action-button { width: 100%; padding: 15px; font-size: 1.1em; font-weight: 700; color: white; border: none; border-radius: 5px; cursor: pointer; margin-top: 10px; }
        .calculate-button { background-color: var(--primary-color); }
        .add-to-project-button { background-color: var(--success-color); display: none; }
        .results-container h3, #project-summary h2 { text-align: center; margin-top: 0; }
        .result-item { text-align: center; padding: 10px; }
        .result-item .value { font-size: 2em; font-weight: 700; color: var(--primary-color); }
        .result-split { display: flex; justify-content: space-around; border-top: 1px solid var(--border-color); margin-top: 10px; }
        #project-summary { border-top: 2px solid var(--secondary-color); margin-top: 40px; padding-top: 25px; }
        #project-summary ul { list-style: none; padding: 0; }
        #project-summary li { display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #fdfdfd; border: 1px solid var(--border-color); border-radius: 5px; margin-bottom: 10px; }
        .project-item-details { display: flex; flex-direction: column; }
        .project-item-yardage { font-size: 0.9em; font-weight: bold; color: var(--primary-color); margin-left: 10px; text-align: right; }
        .remove-item-btn { background: var(--danger-color); color: white; border: none; border-radius: 50%; width: 24px; height: 24px; font-weight: 700; cursor: pointer; flex-shrink: 0; margin-left: 15px;}
        .ad-banner { display: flex; align-items: center; padding: 15px; background: #f8f9fa; border-top: 1px solid var(--border-color); text-decoration: none; color: inherit; }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 200; display: none; justify-content: center; align-items: center; padding: 20px; box-sizing: border-box; }
        .modal-content { background: white; padding: 30px; border-radius: 8px; max-width: 500px; max-height: 80vh; overflow-y: auto; position: relative; }
        .modal-close { position: absolute; top: 10px; right: 10px; background: none; border: none; font-size: 24px; cursor: pointer; }
        #instructions-modal ul { list-style: disc; padding-left: 20px; }

        /* --- MOBILE PADDING ADJUSTMENT --- */
        @media (max-width: 600px) {
            body { padding: 0; }
            .main-container { border-radius: 0; }
            .app-body { padding: 15px; }
            #running-totals-bar { top: 0; border-radius: 0; }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <header class="app-header"><h1 data-translate-key="app_title"></h1></header>
        <section class="language-selector">
            <button class="lang-button selected" data-lang="en">English</button><button class="lang-button" data-lang="es">Español</button>
            <button class="lang-button" data-lang="zh">中文</button><button class="lang-button" data-lang="hi">हिन्दी</button>
        </section>
        <main class="app-body">
            <nav id="navigation-grid" class="navigation-grid"></nav>
            <div id="running-totals-bar">
                <span id="running-totals-text"></span><strong><span id="running-yards"></span> yd³</strong>
            </div>
            <div id="view-container"></div>
            <div id="project-summary"></div>
        </main>
        <a href="https://dailyrig.com" target="_blank" class="ad-banner">
            <img src="https://i.postimg.cc/sXGmdVbr/dr-logo.png" alt="DailyRig Logo">
            <div><h4>DailyRig.com</h4><p data-translate-key="ad_desc"></p></div>
        </a>
    </div>

    <div id="instructions-modal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close">×</button>
            <h2 data-translate-key="instructions_title"></h2>
            <ul data-translate-list="instructions"></ul>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- STATE, CONSTANTS, & ELEMENTS ---
    const CUBIC_FEET_IN_YARD = 27, BAG_80LB_YIELD = 0.60, BAG_60LB_YIELD = 0.45;
    let currentLanguage = 'en', projectItems = [], latestCalcResults = {};
    const viewContainer = document.getElementById('view-container');
    const navGrid = document.getElementById('navigation-grid');
    const projectSummaryContainer = document.getElementById('project-summary');
    const runningTotalsBar = document.getElementById('running-totals-bar');

    // --- TRANSLATIONS (with updated slab/footing key) ---
    const translations = {
        en: { ad_desc: "Direct Trucking & Construction Jobs.", app_title: "Concrete Calculator", clear_button: "Clear Project", slab_footing_title: "Slab / Footing", column_title: "Column / Hole (Round)", circ_slab_title: "Circular Slab", curb_title: "Curb", curb_gutter_title: "Curb & Gutter", stairs_title: "Stairs", project_title: "Project Totals", instructions_title: "Instructions", use_inches_toggle: "Use Inches for Primary Fields", calculate_button: "Calculate", total_needed: "Piece Total", grand_total: "Grand Total", cubic_yards: "Cubic Yards", bags80: "80lb Bags", bags60: "60lb Bags", add_to_project: "Add to Project", running_total_text: (n) => `Project: ${n} Pieces`, length: "Length", width: "Width", thickness: "Thickness", diameter: "Diameter", depth_height: "Depth / Height", curb_height: "Curb Height", curb_width: "Curb Width", gutter_width: "Gutter Width", gutter_thick: "Gutter Thick", num_steps: "Number of Steps", tread_depth: "Tread Depth", riser_height: "Riser Height", stair_width: "Stair Width", waist_thick: "Waist Thick", feet: "ft", inches: "in", inst_1: "1. Choose a calculator from the buttons for your project type (e.g., Slab/Footing, Column).", inst_2: "2. The active calculator is highlighted in blue. Enter your dimensions into the fields.", inst_3: "3. Use the 'Use Inches' toggle if you prefer to enter primary dimensions in inches instead of feet.", inst_4: "4. Press 'Calculate' to see the results for that single piece.", inst_5: "5. To calculate multiple pieces, press 'Add to Project'. This saves the result and instantly resets the form for the next entry.", inst_6: "6. The 'Project Totals' section at the bottom of the page updates automatically with a detailed list of all pieces and their individual yardage.", inst_7: "7. Change the language anytime using the buttons at the top.", project_empty: "Your project is empty. Add items from a calculator to see them here." },
        es: { /* Spanish translations */ },
    };

    const calculators = {
        'slab-footing': { titleKey: 'slab_footing_title', needsToggle: true, inputs: [ {name: 'length', unit: 'feet', switchable: true}, {name: 'width', unit: 'feet', switchable: true}, {name: 'thickness', unit: 'inches', switchable: false} ], calculate: v => getVal(v, 'length') * getVal(v, 'width') * (getRawVal(v, 'thickness') / 12), getDesc: v => `${getRawVal(v, 'length')}${getUnit(v, 'length')} x ${getRawVal(v, 'width')}${getUnit(v, 'width')} x ${getRawVal(v, 'thickness')}${getUnit(v, 'thickness')}` },
        'column': { titleKey: 'column_title', needsToggle: true, inputs: [ {name: 'diameter', unit: 'inches', switchable: false}, {name: 'depth_height', unit: 'feet', switchable: true} ], calculate: v => { const r = (getRawVal(v,'diameter')/12)/2; return Math.PI * r*r * getVal(v,'depth_height'); }, getDesc: v => `${getRawVal(v,'diameter')}${getUnit(v,'diameter')} ⌀ x ${getRawVal(v,'depth_height')}${getUnit(v,'depth_height')}`},
        'circular-slab': { titleKey: 'circ_slab_title', needsToggle: true, inputs: [ {name: 'diameter', unit: 'feet', switchable: true}, {name: 'thickness', unit: 'inches', switchable: false} ], calculate: v => { const r = getVal(v, 'diameter')/2; return Math.PI * r*r * (getRawVal(v, 'thickness')/12); }, getDesc: v => `${getRawVal(v,'diameter')}${getUnit(v,'diameter')} ⌀ x ${getRawVal(v,'thickness')}${getUnit(v,'thickness')}`},
        'curb': { titleKey: 'curb_title', needsToggle: true, inputs: [ {name: 'length', unit: 'feet', switchable: true}, {name: 'curb_height', unit: 'inches', switchable: false}, {name: 'width', unit: 'inches', switchable: false} ], calculate: v => getVal(v, 'length') * (getRawVal(v, 'curb_height')/12) * (getRawVal(v, 'width')/12), getDesc: v => `${getRawVal(v,'length')}${getUnit(v,'length')} long`},
        'curb-gutter': { titleKey: 'curb_gutter_title', needsToggle: true, inputs: [ {name: 'length', unit: 'feet', switchable: true}, {name: 'curb_height', unit: 'inches', switchable: false}, {name: 'curb_width', unit: 'inches', switchable: false}, {name: 'gutter_width', unit: 'inches', switchable: false}, {name: 'gutter_thick', unit: 'inches', switchable: false} ], calculate: v => { const l = getVal(v,'length'), ch = getRawVal(v,'curb_height')/12, cw = getRawVal(v,'curb_width')/12, gw = getRawVal(v,'gutter_width')/12, gt = getRawVal(v,'gutter_thick')/12; return(l*ch*cw)+(l*gw*gt); }, getDesc: v => `${getRawVal(v,'length')}${getUnit(v,'length')} long`},
        'stairs': { titleKey: 'stairs_title', needsToggle: true, inputs: [ {name: 'num_steps', unit: '', switchable: false}, {name: 'tread_depth', unit: 'inches', switchable: false}, {name: 'riser_height', unit: 'inches', switchable: false}, {name: 'stair_width', unit: 'feet', switchable: true}, {name: 'waist_thick', unit: 'inches', switchable: false} ], calculate: v => { const n=getRawVal(v,'num_steps'), t=getRawVal(v,'tread_depth')/12, r=getRawVal(v,'riser_height')/12, w=getVal(v,'stair_width'), a=getRawVal(v,'waist_thick')/12, s=n*(.5*t*r*w), l=Math.sqrt(Math.pow(n*t,2)+Math.pow(n*r,2)); return s+l*w*a; }, getDesc: v => `${getRawVal(v,'num_steps')} steps, ${getRawVal(v,'stair_width')}${getUnit(v,'stair_width')} wide`},
    };
    
    function initializeApp() {
        Object.keys(calculators).forEach(id => navGrid.innerHTML += `<button class="nav-button" data-view-id="${id}" data-translate-key="${calculators[id].titleKey}"></button>`);
        navGrid.innerHTML += `<button class="nav-button" id="instructions-nav-btn" data-translate-key="instructions_title"></button>`;
        let allViewsHTML = '';
        Object.entries(calculators).forEach(([id, config]) => {
            let inputsHTML = config.inputs.map(i => `<div class="form-row" data-switchable="${i.switchable}"><span data-translate-key="${i.name}"></span><div class="input-group"><input type="number" name="${i.name}"><span class="unit" data-translate-key-unit="${i.unit}"></span></div></div>`).join('');
            allViewsHTML += `<div id="${id}" class="app-view form-group">${config.needsToggle ? `<div class="unit-toggle-container"><span data-translate-key="use_inches_toggle"></span><label class="toggle-switch"><input type="checkbox" class="unit-toggle"><span class="slider"></span></label></div>` : ''}<div class="form-inputs">${inputsHTML}</div><button class="action-button calculate-button" data-translate-key="calculate_button"></button><div class="results-container" style="display:none;"></div><button class="action-button add-to-project-button" data-translate-key="add_to_project"></button></div>`;
        });
        viewContainer.innerHTML = allViewsHTML;
        
        navGrid.querySelectorAll('.nav-button').forEach(btn => btn.addEventListener('click', handleNavClick));
        Object.entries(calculators).forEach(([id, config]) => {
            const view = document.getElementById(id);
            view.querySelector('.calculate-button').addEventListener('click', () => handleCalculate(view, config, id));
            view.querySelector('.add-to-project-button').addEventListener('click', e => handleAddToProject(e.target, id));
            if(config.needsToggle) { view.querySelector('.unit-toggle').addEventListener('change', () => setLanguage(currentLanguage)); }
        });
        document.querySelectorAll('.lang-button').forEach(btn => btn.addEventListener('click', e => setLanguage(e.target.dataset.lang)));
        document.getElementById('instructions-nav-btn').addEventListener('click', () => document.getElementById('instructions-modal').style.display = 'flex');
        document.querySelector('.modal-close').addEventListener('click', () => document.getElementById('instructions-modal').style.display = 'none');
        
        renderProjectView(); showView('slab-footing'); setLanguage('en');
    }

    function handleNavClick(e) { showView(e.currentTarget.dataset.viewId); }
    
    function handleCalculate(view, config, id) {
        const volume = config.calculate(view);
        if (isNaN(volume) || volume <= 0) { alert("Please enter valid numbers in all fields."); return; }
        latestCalcResults[id] = { name: translations[currentLanguage][config.titleKey], desc: config.getDesc(view), volume: volume };
        const resultsContainer = view.querySelector('.results-container');
        resultsContainer.style.display = 'block';
        resultsContainer.innerHTML = `<h3 data-translate-key="total_needed"></h3><div class="result-item"><span class="value">${(volume / CUBIC_FEET_IN_YARD).toFixed(2)}</span><span data-translate-key="cubic_yards"></span></div><div class="result-split"><div class="result-item"><span class="value">${Math.ceil(volume / BAG_80LB_YIELD)}</span><span data-translate-key="bags80"></span></div><div class="result-item"><span class="value">${Math.ceil(volume / BAG_60LB_YIELD)}</span><span data-translate-key="bags60"></span></div></div>`;
        view.querySelector('.add-to-project-button').style.display = 'block';
        setLanguage(currentLanguage);
    }

    function handleAddToProject(button, id) {
        if (!latestCalcResults[id]) return;
        projectItems.push({ id: Date.now(), ...latestCalcResults[id] });
        delete latestCalcResults[id];
        updateRunningTotals(); renderProjectView();
        const view = button.closest('.app-view');
        view.querySelectorAll('input[type="number"]').forEach(input => input.value = '');
        view.querySelector('.results-container').style.display = 'none';
        button.style.display = 'none';
    }

    function showView(viewId) {
        document.querySelectorAll('.app-view').forEach(v => v.classList.remove('active'));
        const view = document.getElementById(viewId);
        if (view) view.classList.add('active');
        document.querySelectorAll('.nav-button').forEach(btn => btn.classList.toggle('active', btn.dataset.viewId === viewId));
    }
    
    function renderProjectView() {
        let content = `<h2 data-translate-key="project_title"></h2><ul>`;
        if (projectItems.length === 0) {
            content += `<li data-translate-key="project_empty"></li></ul>`;
        } else {
            let totalVolume = 0;
            projectItems.forEach(item => {
                totalVolume += item.volume;
                const itemYards = (item.volume / CUBIC_FEET_IN_YARD).toFixed(2);
                content += `<li><div class="project-item-details"><span class="project-item-title">${item.name}</span><span class="project-item-desc">${item.desc}</span></div><div class="project-item-yardage">${itemYards} yd³</div><button class="remove-item-btn" data-id="${item.id}">×</button></li>`;
            });
            content += `</ul><div class="results-container" style="display:block;"><h3 data-translate-key="grand_total"></h3><div class="result-item"><span class="value">${(totalVolume / CUBIC_FEET_IN_YARD).toFixed(2)}</span><span data-translate-key="cubic_yards"></span></div><div class="result-split"><div class="result-item"><span class="value">${Math.ceil(totalVolume / BAG_80LB_YIELD)}</span><span data-translate-key="bags80"></span></div><div class="result-item"><span class="value">${Math.ceil(totalVolume / BAG_60LB_YIELD)}</span><span data-translate-key="bags60"></span></div></div><button id="clear-project-btn" class="action-button" style="background-color: var(--danger-color);" data-translate-key="clear_button"></button></div>`;
        }
        projectSummaryContainer.innerHTML = content;
        if(document.getElementById('clear-project-btn')) { document.getElementById('clear-project-btn').addEventListener('click', clearProject); }
        projectSummaryContainer.querySelectorAll('.remove-item-btn').forEach(btn => btn.addEventListener('click', (e) => {
            projectItems = projectItems.filter(i => i.id !== parseInt(e.target.dataset.id));
            updateRunningTotals(); renderProjectView();
        }));
        setLanguage(currentLanguage);
    }
    
    function clearProject() { projectItems = []; updateRunningTotals(); renderProjectView(); }
    
    function updateRunningTotals() {
        if (projectItems.length === 0) {
            runningTotalsBar.style.display = 'none'; return;
        }
        runningTotalsBar.style.display = 'flex';
        const totalVolume = projectItems.reduce((acc, item) => acc + item.volume, 0);
        runningTotalsBar.querySelector('#running-yards').textContent = (totalVolume / CUBIC_FEET_IN_YARD).toFixed(2);
        runningTotalsBar.querySelector('#running-totals-text').textContent = translations[currentLanguage].running_total_text(projectItems.length);
    }

    function setLanguage(lang) {
        currentLanguage = lang;
        if (!translations[lang] || Object.keys(translations[lang]).length < 15) { translations[lang] = {...translations.en, ...translations[lang]}; }
        const dict = translations[lang];
        document.querySelectorAll('[data-translate-key]').forEach(el => el.textContent = dict[el.dataset.translateKey]);
        const instructionList = document.querySelector('[data-translate-list="instructions"]');
        if(instructionList) {
            instructionList.innerHTML = '';
            for(let i=1; i<=7; i++){ if(dict[`inst_${i}`]) instructionList.innerHTML += `<li>${dict[`inst_${i}`]}</li>`; }
        }
        document.querySelectorAll('[data-translate-key-unit]').forEach(el => {
            const row = el.closest('.form-row');
            const toggle = el.closest('.app-view')?.querySelector('.unit-toggle');
            el.textContent = (row?.dataset.switchable === 'true' && toggle?.checked) ? dict['inches'] : dict[el.dataset.translateKeyUnit];
        });
        document.querySelectorAll('.lang-button').forEach(btn => btn.classList.toggle('selected', btn.dataset.lang === lang));
        updateRunningTotals();
    }
    
    const getUnit = (v, n) => v.querySelector(`[name="${n}"]`).closest('.input-group').querySelector('.unit').textContent;
    const getRawVal = (v, n) => parseFloat(v.querySelector(`[name="${n}"]`).value) || 0;
    const getVal = (v, n) => (v.querySelector(`[name="${n}"]`).closest('.form-row').dataset.switchable === 'true' && v.querySelector('.unit-toggle')?.checked) ? getRawVal(v, n) / 12 : getRawVal(v, n);
    
    initializeApp();
});
</script>
</body>
</html>
